<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Elytron: Web Services client integration with Elytron</title>
    <script src="/wildfly-elytron/assets/javascript/highlight.pack.js" type="text/javascript"></script>

    <link rel="shortcut icon" type="image/png" href="/wildfly-elytron/favicon.ico">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <!-- We override the colours from this theme manually -->
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
    <link rel="stylesheet" href="/wildfly-elytron/assets/css/styles.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
    <script src="/wildfly-elytron/assets/javascript/hl.js" type="text/javascript"></script>
    <link rel="alternate" type="application/rss+xml"  href="/wildfly-elytron/feed.xml" title="WildFly Elytron">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-135301155-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-135301155-1');
    </script>
</head>
<body>


<!-- Always shows a header, even in smaller screens. -->
<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
    <header class="mdl-layout__header mdl-layout__header--scroll">
        <div class="mdl-layout__header-row ">
            <!-- Title -->
            <span class="mdl-layout-title"><h3>Wild<strong>Fly</strong>  Elytron</h3></span>
            <!-- Add spacer, to align navigation to the right -->
            <div class="mdl-layout-spacer"></div>
            <nav class="mdl-navigation mdl-layout--large-screen-only">
                
                    
                    
                         <a class="mdl-navigation__link Home-menuitem" href="/wildfly-elytron/">Home</a>
                    
                
                    
                    
                         <a class="mdl-navigation__link Docs-menuitem" href="https://docs.wildfly.org/19/WildFly_Elytron_Security.html">Docs</a>
                    
                
                    
                    
                         <a class="mdl-navigation__link Community-menuitem" href="/wildfly-elytron/community/">Community</a>
                    
                
                    
                    
                         <a class="mdl-navigation__link mdl-navigation__link--current Blog-menuitem" href="/wildfly-elytron/blog/">Blog</a>
                    
                
                    
                    
                         <a class="mdl-navigation__link GitHub-menuitem" href="https://github.com/wildfly-security/wildfly-elytron">GitHub</a>
                    
                
            </nav>
        </div>
    </header>
    <div class="mdl-layout__drawer">
        <div class="side-drawer-logo-container"><h3>Wild<strong>Fly</strong>  Elytron</h3></div>
        <nav class="mdl-navigation">
            
            
            
                <a class="mdl-navigation__link Home-menuitem" href="/wildfly-elytron/">Home</a>
            
            
            
            
                <a class="mdl-navigation__link Docs-menuitem" href="https://docs.wildfly.org/19/WildFly_Elytron_Security.html">Docs</a>
            
            
            
            
                <a class="mdl-navigation__link Community-menuitem" href="/wildfly-elytron/community/">Community</a>
            
            
            
            
                <a class="mdl-navigation__link mdl-navigation__link--current Blog-menuitem" href="/wildfly-elytron/blog/">Blog</a>
            
            
            
            
                <a class="mdl-navigation__link GitHub-menuitem" href="https://github.com/wildfly-security/wildfly-elytron">GitHub</a>
            
            
            <!-- mdl-navigation__link--current -->
        </nav>
    </div>
    <main class="mdl-layout__content">
        <div class="page-content">
            
            <div class="content">
                <div class="post-page grid-wrapper">
  <div class="grid__item width-12-12 width-12-12-m doc-content">
    <h1>Web Services client integration with Elytron</h1>
    <div class="grid-wrapper">
      <div class="grid__item width-8-12 width-12-12-m byline-wrapper">
        
        
          <img class="headshot" src="https://www.gravatar.com/avatar/4336bee4b72f539ef5f8cc0d2c6026f5">
        
        <p class="byline">By <a href="https://github.com/Skyllarr">Diana Vilkolakova</a> | March 18, 2020</p>
      </div>
      
      <div class="grid__item width-4-12 width-12-12-m"><div class="share-page">
  <a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https://wildfly-security.github.io/wildfly-elytron/blog/ws-elytron-client-integration/&title=Web Services client integration with Elytron" rel="nofollow" target="_blank" title="Share on LinkedIn">
    <i class="fab fa-linkedin"></i>
  </a>
  <a class="share-twitter" href="https://twitter.com/intent/tweet?text=Web Services client integration with Elytron&url=https://wildfly-security.github.io/wildfly-elytron/blog/ws-elytron-client-integration/&via=WildFlyAS&related=WildFlyAS" rel="nofollow" target="_blank" title="Share on Twitter">
    <i class="fab fa-twitter-square"></i>
  </a>
  <a class="share-facebook" href="https://facebook.com/sharer.php?u=https://wildfly-security.github.io/wildfly-elytron/blog/ws-elytron-client-integration/" rel="nofollow" target="_blank" title="Share on Facebook">
    <i class="fab fa-facebook-square"></i>
  </a>
  <a class="share-reddit" href="http://www.reddit.com/submit?url=https://wildfly-security.github.io/wildfly-elytron/blog/ws-elytron-client-integration/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" title="Share on Reddit" >
    <i class="fab fa-reddit-square"></i>
  </a>
  <a class="share-email" href="mailto:?subject=Web Services client integration with Elytron&amp;body=Web Services client integration with Elytron https://wildfly-security.github.io/wildfly-elytron/blog/ws-elytron-client-integration/" title="Share via Email" >
    <i class="fas fa-envelope-square"></i>
  </a>
</div>
</div>
      <div class="grid__item width-12-12">
          <div class="paragraph">
<p>It is now possible for Web Services client to automatically load and use authentication configuration from Elytron client to connect to a secured server. This blog post will give an introduction to this new feature.</p>
</div>
<div class="sect1">
<h2 id="scope-of-the-integration"><a class="anchor" href="#scope-of-the-integration"></a>Scope of the integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Elytron client must be on classpath during <a href="https://docs.jboss.org/author/display/JBWS/Predefined+client+and+endpoint+configurations">assigning of configurations</a> for WS client in order for this integration to take place.</p>
</div>
<div class="paragraph">
<p>WS client will automatically use <code>username</code>, <code>password</code> and <code>SSL context</code> configured in Elytron client. Credentials will be used for <code>HTTP BASIC authentication</code> or <code>Username Token Profile</code> authentication. Elytron client configuration was extended to include option that specifies which of these mechanisms should be used.</p>
</div>
<div class="paragraph">
<p>Any existing configuration a client already had configured will not be re-written. Configuration specified by user in default WS client descriptor within the application (<code>jaxws-client-config.xml</code>) has precedence.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configure-elytron-client"><a class="anchor" href="#configure-elytron-client"></a>Configure Elytron client</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Elytron client allows for both use of an <code>Elytron API</code> and pre-defined configurations in the xml file (<code>wildfly-config.xml</code>) to enable remote clients to authenticate using Elytron. For more information please see <a href="https://docs.jboss.org/author/display/WFLY/Client+Authentication+with+Elytron+Client">the documentation</a>. SSL context configuration did not change and WS client will use it automatically.</p>
</div>
<div class="paragraph">
<p>Below is an example of <code>wildfly-config.xml</code> that contains configuration of mechanisms that WS client should use with Elytron client credentials:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="xml" class="language-xml hljs">&lt;authentication-configurations&gt;
    ...
    &lt;configuration&gt;
        ...
        &lt;webservices&gt;
            &lt;ws-security type="UsernameToken"&gt;
            &lt;set-http-mechanism name="BASIC"/&gt;
        &lt;/webservices&gt;
        ...
    &lt;/configuration&gt;
&lt;/authentication-configurations&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>&lt;webservices /&gt;</em> element can optionally contain the following child elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;set-http-mechanism name="BASIC"/&gt;</code> This element is used to specify an HTTP mechanism that WS client should use to authenticate. Currently only the HTTP Basic authentication is supported and used as default.</p>
</li>
<li>
<p><code>&lt;set-ws-security-type name="UsernameToken"/&gt;</code> This element is used to specify WS-Security type that WS client will use to authenticate with the server. Currently only Username Token Profile can be configured.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is also possible to configure these mechanisms programmatically:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="xml" class="language-xml hljs">AuthenticationConfiguration ac = AuthenticationConfiguration.empty().useWebServices(
                Map.ofEntries(
                        entry("http-mechanism", "BASIC"),
                        entry("ws-security-type", "UsernameToken")
                ));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The mechanisms will take effect only if both username and password are configured in Elytron client.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="use-web-services-client"><a class="anchor" href="#use-web-services-client"></a>Use Web Services client</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JBossWS API comes with facility classes that can be used for assigning of configurations when building a client. For more information, you can take a look at the documentation <a href="https://github.com/wildfly/wildfly/blob/master/docs/src/main/asciidoc/_developer-guide/jax-ws/Predefined_client_and_endpoint_configurations.adoc#explicit-setup-through-API">here</a>.</p>
</div>
<div class="paragraph">
<p>For integration to work it is necessary to use <code>jbossws-cxf</code> client, specifically <code>CXFClientConfigurer</code> class and its method <code>setConfigProperties</code>. Whenever this method is called, with or without other WS config files, Elytron client credentials and SSLContext will be used if present. Below are possible uses of this method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">Service service = Service.create(wsdlURL, serviceName);
Endpoint port = service.getPort(Endpoint.class);
CXFClientConfigurer configurer = new CXFClientConfigurer();
configurer.setConfigProperties(port, null, null);   // use null value if there is no other WS configuration
port.echo("Kermit");
...
configurer.setConfigProperties(port, "META-INF/my-client-config.xml", "Custom Client Config 3");
port.echo("Kermit");
...
configurer.setConfigProperties(port, null, "Container Custom Client Config");
port.echo("Kermit");</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="example"><a class="anchor" href="#example"></a>Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Working example demonstrating this integration can be found <a href="https://github.com/wildfly-security-incubator/elytron-examples/tree/master/ws-client-integration">here</a>. In this example, two-way SSL is configured on the server. Additionally, HTTP BASIC authentication is required to connect to the server as well. Web Services client uses SSLContext and credentials from Elytron client to successfully connect to the server.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="summary"><a class="anchor" href="#summary"></a>Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This blog post has given an overview on how Web Services client can use Elytron client configuration when connecting to a secured server. For more information you can take a look at <a href="https://docs.jboss.org/author/display/WFLY/Client+Authentication+with+Elytron+Client">Elytron client documentation</a> and
<a href="https://docs.jboss.org/author/display/WFLY10/Webservices+reference+guide">Web Services reference guide</a>.</p>
</div>
</div>
</div>
      </div>
    </div>
  </div>
</div>

            </div>
        </div>
    </main>
</div>
</body>
</html>
