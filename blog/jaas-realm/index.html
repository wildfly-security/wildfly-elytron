<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Elytron: Using a JAAS realm in Elytron</title>
    <script src="/wildfly-elytron/assets/javascript/highlight.pack.js" type="text/javascript"></script>

    <link rel="shortcut icon" type="image/png" href="/wildfly-elytron/favicon.ico">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <!-- We override the colours from this theme manually -->
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
    <link rel="stylesheet" href="/wildfly-elytron/assets/css/styles.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
    <script src="/wildfly-elytron/assets/javascript/hl.js" type="text/javascript"></script>
    <link rel="alternate" type="application/rss+xml"  href="/wildfly-elytron/feed.xml" title="WildFly Elytron">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-135301155-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-135301155-1');
    </script>
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Using a JAAS realm in Elytron | WildFly Elytron</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Using a JAAS realm in Elytron" />
<meta name="author" content="Diana Krepinska Vilkolakova" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The Elytron subsystem already provides various security realms like LDAP realm, JDBC realm, filesystem realm, and others for common use cases. Starting from WildFly 26, you can also configure a JAAS security realm in the Elytron subsystem in order to use custom Login Modules for authentication and authorization." />
<meta property="og:description" content="The Elytron subsystem already provides various security realms like LDAP realm, JDBC realm, filesystem realm, and others for common use cases. Starting from WildFly 26, you can also configure a JAAS security realm in the Elytron subsystem in order to use custom Login Modules for authentication and authorization." />
<link rel="canonical" href="https://wildfly-security.github.io/wildfly-elytron/blog/jaas-realm/" />
<meta property="og:url" content="https://wildfly-security.github.io/wildfly-elytron/blog/jaas-realm/" />
<meta property="og:site_name" content="WildFly Elytron" />
<meta property="og:image" content="https://wildfly-security.github.io/wildfly-elytron/assets/images/wildfly-elytron-logo.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-12-17T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://wildfly-security.github.io/wildfly-elytron/assets/images/wildfly-elytron-logo.jpg" />
<meta property="twitter:title" content="Using a JAAS realm in Elytron" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Diana Krepinska Vilkolakova"},"dateModified":"2021-12-17T00:00:00+00:00","datePublished":"2021-12-17T00:00:00+00:00","description":"The Elytron subsystem already provides various security realms like LDAP realm, JDBC realm, filesystem realm, and others for common use cases. Starting from WildFly 26, you can also configure a JAAS security realm in the Elytron subsystem in order to use custom Login Modules for authentication and authorization.","headline":"Using a JAAS realm in Elytron","image":"https://wildfly-security.github.io/wildfly-elytron/assets/images/wildfly-elytron-logo.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://wildfly-security.github.io/wildfly-elytron/blog/jaas-realm/"},"url":"https://wildfly-security.github.io/wildfly-elytron/blog/jaas-realm/"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>


<!-- Always shows a header, even in smaller screens. -->
<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
    <header class="mdl-layout__header mdl-layout__header--scroll">
        <div class="mdl-layout__header-row ">
            <!-- Title -->
            <span class="mdl-layout-title"><h3>Wild<strong>Fly</strong>  Elytron</h3></span>
            <!-- Add spacer, to align navigation to the right -->
            <div class="mdl-layout-spacer"></div>
            <nav class="mdl-navigation mdl-layout--large-screen-only">
                
                    
                    
                    
                         <a class="mdl-navigation__link highlight-button OSD 2022-menuitem" href="/wildfly-elytron/OSD-2022/">OSD 2022</a>
                    
                
                    
                    
                    
                         <a class="mdl-navigation__link Home-menuitem" href="/wildfly-elytron/">Home</a>
                    
                
                    
                    
                    
                         <a class="mdl-navigation__link Guides-menuitem" href="/wildfly-elytron/guides/">Guides</a>
                    
                
                    
                    
                    
                         <a class="mdl-navigation__link Docs-menuitem" href="/wildfly-elytron/docs/">Docs</a>
                    
                
                    
                    
                    
                         <a class="mdl-navigation__link Community-menuitem" href="/wildfly-elytron/community/">Community</a>
                    
                
                    
                    
                    
                         <a class="mdl-navigation__link mdl-navigation__link--current Blog-menuitem" href="/wildfly-elytron/blog/">Blog</a>
                    
                
                    
                    
                    
                         <a class="mdl-navigation__link GitHub-menuitem" href="https://github.com/wildfly-security/wildfly-elytron">GitHub</a>
                    
                
            </nav>
        </div>
    </header>
    <div class="mdl-layout__drawer">
        <div class="side-drawer-logo-container"><h3>Wild<strong>Fly</strong>  Elytron</h3></div>
        <nav class="mdl-navigation">
            
            
            
            
                <a class="mdl-navigation__link highlight-sidebar OSD 2022-menuitem" href="/wildfly-elytron/OSD-2022/">OSD 2022</a>
            
            
            
            
            
                <a class="mdl-navigation__link Home-menuitem" href="/wildfly-elytron/">Home</a>
            
            
            
            
            
                <a class="mdl-navigation__link Guides-menuitem" href="/wildfly-elytron/guides/">Guides</a>
            
            
            
            
            
                <a class="mdl-navigation__link Docs-menuitem" href="/wildfly-elytron/docs/">Docs</a>
            
            
            
            
            
                <a class="mdl-navigation__link Community-menuitem" href="/wildfly-elytron/community/">Community</a>
            
            
            
            
            
                <a class="mdl-navigation__link mdl-navigation__link--current Blog-menuitem" href="/wildfly-elytron/blog/">Blog</a>
            
            
            
            
            
                <a class="mdl-navigation__link GitHub-menuitem" href="https://github.com/wildfly-security/wildfly-elytron">GitHub</a>
            
            
            <!-- mdl-navigation__link--current -->
        </nav>
    </div>
    <main class="mdl-layout__content">
        <div class="page-content">
            
            <div class="content">
                <div class="post-page grid-wrapper">
  <div class="grid__item width-12-12 width-12-12-m doc-content">
    <h1>Using a JAAS realm in Elytron</h1>
    <div class="grid-wrapper">
      <div class="grid__item width-8-12 width-12-12-m byline-wrapper">
        
        
          <img class="headshot" src="https://www.gravatar.com/avatar/4336bee4b72f539ef5f8cc0d2c6026f5">
        
        <p class="byline">
          By <a href="https://github.com/Skyllarr">Diana Krepinska Vilkolakova</a> | December 17, 2021
          <br>
          
            
              <a style="font-size: 0.9em;" href="/wildfly-elytron/blog/tag/jaas"> #jaas</a>
            
              <a style="font-size: 0.9em;" href="/wildfly-elytron/blog/tag/security-realm"> #security-realm</a>
            
              <a style="font-size: 0.9em;" href="/wildfly-elytron/blog/tag/login-module"> #login-module</a>
            
              <a style="font-size: 0.9em;" href="/wildfly-elytron/blog/tag/login-context"> #login-context</a>
            
          
        </p>
      </div>
      
      <div class="grid__item width-4-12 width-12-12-m"><div class="share-page">
  <a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https://wildfly-security.github.io/wildfly-elytron/blog/jaas-realm/&title=Using a JAAS realm in Elytron" rel="nofollow" target="_blank" title="Share on LinkedIn">
    <i class="fab fa-linkedin"></i>
  </a>
  <a class="share-twitter" href="https://twitter.com/intent/tweet?text=Using a JAAS realm in Elytron&url=https://wildfly-security.github.io/wildfly-elytron/blog/jaas-realm/&via=WildFlyAS&related=WildFlyAS" rel="nofollow" target="_blank" title="Share on Twitter">
    <i class="fab fa-twitter-square"></i>
  </a>
  <a class="share-facebook" href="https://facebook.com/sharer.php?u=https://wildfly-security.github.io/wildfly-elytron/blog/jaas-realm/" rel="nofollow" target="_blank" title="Share on Facebook">
    <i class="fab fa-facebook-square"></i>
  </a>
  <a class="share-reddit" href="http://www.reddit.com/submit?url=https://wildfly-security.github.io/wildfly-elytron/blog/jaas-realm/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" title="Share on Reddit" >
    <i class="fab fa-reddit-square"></i>
  </a>
  <a class="share-email" href="mailto:?subject=Using a JAAS realm in Elytron&amp;body=Using a JAAS realm in Elytron https://wildfly-security.github.io/wildfly-elytron/blog/jaas-realm/" title="Share via Email" >
    <i class="fas fa-envelope-square"></i>
  </a>
</div>
</div>
      <div class="grid__item width-12-12">
          <div class="paragraph">
<p>The Elytron subsystem already provides various security realms like LDAP realm, JDBC realm, filesystem realm, and others for common use cases. Starting from WildFly 26, you can also configure a JAAS security realm in the Elytron subsystem in order to use custom Login Modules for authentication and authorization.</p>
</div>
<div class="paragraph">
<p>A JAAS realm utilizes a <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/javax/security/auth/login/LoginContext.html">LoginContext</a> initialized from a <a href="https://docs.oracle.com/en/java/javase/17/security/appendix-b-jaas-login-configuration-file.html">JAAS configuration file</a> to authenticate and authorize users with custom <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/javax/security/auth/spi/LoginModule.html">Login Modules</a>. Flags and options can be specified in a <a href="https://docs.oracle.com/en/java/javase/17/security/appendix-b-jaas-login-configuration-file.html">JAAS configuration file</a> according to the <a href="https://docs.oracle.com/en/java/javase/17/security/appendix-b-jaas-login-configuration-file.html">Java documentation</a>.</p>
</div>
<div class="sect1">
<h2 id="add-a-jaas-realm"><a class="anchor" href="#add-a-jaas-realm"></a>Add a JAAS realm</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can add a <code>jaas-realm</code> to the Elytron subsystem by specifying the following attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>entry</code> JAAS configuration file entry name</p>
</li>
<li>
<p><code>path</code> Path to the JAAS configuration file. You can also specify the location of the configuration with java system property "java.security.auth.login.config" or with java security property "login.config.url"</p>
</li>
<li>
<p><code>relative-to</code> Optional base folder for the <code>path</code>.</p>
</li>
<li>
<p><code>module</code> The WildFly module with Login Module implementations and Callback Handler implementation.</p>
</li>
<li>
<p><code>callback-handler</code> Callback handler to use with the Login Context. Security property "auth.login.defaultCallbackHandler" can be used instead. The default callback handler of the realm will be used if none of these are defined.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Attribute <code>entry</code> is required and all other attributes are optional.</p>
</div>
<div class="paragraph">
<p>Example of configuration via CLI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">/subsystem=elytron/jaas-realm=jaasRealmExample:add(
        entry=Entry1,
        path=/path/to/JAAS-config-file.conf,
        module=moduleContainingCustomImpls,
        callback-handler=loginmodules.CustomCallbackHandler)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="principals-to-attributes-mapping"><a class="anchor" href="#principals-to-attributes-mapping"></a>Principals to attributes mapping</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Elytron subsystem can have attributes associated with authenticated users. These attributes can be for example a name, email, phone number.</p>
</div>
<div class="paragraph">
<p><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/javax/security/auth/spi/LoginModule.html">Login Modules</a> use <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/javax/security/auth/Subject.html">Subjects</a> to represent the user currently being authenticated. Subject&#8217;s
<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/security/Principal.html">principals</a> are mapped to user&#8217;s attributes with the following rule:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>key</strong> of the attribute is principal’s simple classname, so the value of <code>principal.getClass().getSimpleName())</code></p>
</li>
<li>
<p><strong>value</strong> is principal’s name, so the result of <code>principal.getName()</code> call. For principals of the same type / key, the values will be appended to the collection under this attribute key.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example</strong>: Authenticated Subject contains 2 principals of type <code>org.my.principal.Email</code>. First principal has name <code>first@email.com</code> and second <code>second@email.com</code>. The result will be a single attribute with a name <code>Email</code> and its value will be collection containing values <a href="mailto:first@email.com">first@email.com</a> and <a href="mailto:second@email.com">second@email.com</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="roles-for-authorization"><a class="anchor" href="#roles-for-authorization"></a>Roles for authorization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Attributes can be used to associate roles with the authenticated user. The default attribute name for roles in the Elytron subsystem is <code>Roles</code>. This means that users can create their own implementation of <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/security/Principal.html">Principal interface</a> that will be named Roles. Each instance of this principal contains a name, which should be the role belonging to the authenticated user.  To associate multiple roles with the authenticated user, multiple principals of type <code>Roles</code> have to be added to the subject.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">private static class Roles implements Principal {

        private final String name;

        Roles(final String name) {
            this.name = name;
        }

        public String getName() {
            return this.name;
        }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the Login Module implementation, you can add roles to your Subject with the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">this.subject.getPrincipals().add(new Roles("Admin"));
this.subject.getPrincipals().add(new Roles("Guest"));</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> You can define role decoders in the Elytron subsystem to use different attribute for role mapping.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="example"><a class="anchor" href="#example"></a>Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can take a look at a following <a href="https://github.com/wildfly-security-incubator/elytron-examples/tree/master/jaas-realm">example</a> that uses <code>jaas-realm</code> with custom LoginModule implementations.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="summary"><a class="anchor" href="#summary"></a>Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This blog post has given an overview of <code>jaas-realm</code> usage in the Elytron subsystem. You can check out <a href="https://docs.wildfly.org/26/WildFly_Elytron_Security.html#jaas-security-realm">Elytron documentation</a> for more information.</p>
</div>
</div>
</div>
      </div>
    </div>
  </div>
</div>

            </div>
        </div>
    </main>
</div>
</body>
</html>
