<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Elytron: Using Credential Stores to Replace Clear Text Passwords in WildFly</title>
    <script src="/wildfly-elytron/assets/javascript/highlight.pack.js" type="text/javascript"></script>

    <link rel="shortcut icon" type="image/png" href="/wildfly-elytron/favicon.ico">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <!-- We override the colours from this theme manually -->
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
    <link rel="stylesheet" href="/wildfly-elytron/assets/css/styles.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
    <script src="/wildfly-elytron/assets/javascript/hl.js" type="text/javascript"></script>
    <link rel="alternate" type="application/rss+xml"  href="/wildfly-elytron/feed.xml" title="WildFly Elytron">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-135301155-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-135301155-1');
    </script>
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Using Credential Stores to Replace Clear Text Passwords in WildFly | WildFly Elytron</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Using Credential Stores to Replace Clear Text Passwords in WildFly" />
<meta name="author" content="Prarthona Paul" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="WildFly allows the use of credential stores to keep aliases for sensitive information, such as, passwords for external services. Credential stores can be used to store different credentials under aliases and use credential-reference to specify them in server configuration. As a result, the credential is no longer visible in clear text." />
<meta property="og:description" content="WildFly allows the use of credential stores to keep aliases for sensitive information, such as, passwords for external services. Credential stores can be used to store different credentials under aliases and use credential-reference to specify them in server configuration. As a result, the credential is no longer visible in clear text." />
<link rel="canonical" href="https://wildfly-security.github.io/wildfly-elytron/blog/credential-store-for-passwords/" />
<meta property="og:url" content="https://wildfly-security.github.io/wildfly-elytron/blog/credential-store-for-passwords/" />
<meta property="og:site_name" content="WildFly Elytron" />
<meta property="og:image" content="https://wildfly-security.github.io/wildfly-elytron/assets/images/wildfly-elytron-logo.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-08-14T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://wildfly-security.github.io/wildfly-elytron/assets/images/wildfly-elytron-logo.jpg" />
<meta property="twitter:title" content="Using Credential Stores to Replace Clear Text Passwords in WildFly" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Prarthona Paul"},"dateModified":"2024-08-14T00:00:00+00:00","datePublished":"2024-08-14T00:00:00+00:00","description":"WildFly allows the use of credential stores to keep aliases for sensitive information, such as, passwords for external services. Credential stores can be used to store different credentials under aliases and use credential-reference to specify them in server configuration. As a result, the credential is no longer visible in clear text.","headline":"Using Credential Stores to Replace Clear Text Passwords in WildFly","image":"https://wildfly-security.github.io/wildfly-elytron/assets/images/wildfly-elytron-logo.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://wildfly-security.github.io/wildfly-elytron/blog/credential-store-for-passwords/"},"url":"https://wildfly-security.github.io/wildfly-elytron/blog/credential-store-for-passwords/"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>


<!-- Always shows a header, even in smaller screens. -->
<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
    <header class="mdl-layout__header mdl-layout__header--scroll">
        <div class="mdl-layout__header-row ">
            <!-- Title -->
            <span class="mdl-layout-title"><h3>Wild<strong>Fly</strong>  Elytron</h3></span>
            <!-- Add spacer, to align navigation to the right -->
            <div class="mdl-layout-spacer"></div>
            <nav class="mdl-navigation mdl-layout--large-screen-only">
                
                    
                    
                    
                         <a class="mdl-navigation__link highlight-button Contribute-menuitem" href="/wildfly-elytron/contribute/">Contribute</a>
                    
                
                    
                    
                    
                         <a class="mdl-navigation__link Home-menuitem" href="/wildfly-elytron/">Home</a>
                    
                
                    
                    
                    
                         <a class="mdl-navigation__link Guides-menuitem" href="/wildfly-elytron/guides/">Guides</a>
                    
                
                    
                    
                    
                         <a class="mdl-navigation__link Docs-menuitem" href="/wildfly-elytron/docs/">Docs</a>
                    
                
                    
                    
                    
                         <a class="mdl-navigation__link Community-menuitem" href="/wildfly-elytron/community/">Community</a>
                    
                
                    
                    
                    
                         <a class="mdl-navigation__link mdl-navigation__link--current Blog-menuitem" href="/wildfly-elytron/blog/">Blog</a>
                    
                
                    
                    
                    
                         <a class="mdl-navigation__link GitHub-menuitem" href="https://github.com/wildfly-security/wildfly-elytron">GitHub</a>
                    
                
                    
                    
                    
                         <a class="mdl-navigation__link CVE Reporting-menuitem" href="/wildfly-elytron/security/">CVE Reporting</a>
                    
                
            </nav>
        </div>
    </header>
    <div class="mdl-layout__drawer">
        <div class="side-drawer-logo-container"><h3>Wild<strong>Fly</strong>  Elytron</h3></div>
        <nav class="mdl-navigation">
            
            
            
            
                <a class="mdl-navigation__link highlight-sidebar Contribute-menuitem" href="/wildfly-elytron/contribute/">Contribute</a>
            
            
            
            
            
                <a class="mdl-navigation__link Home-menuitem" href="/wildfly-elytron/">Home</a>
            
            
            
            
            
                <a class="mdl-navigation__link Guides-menuitem" href="/wildfly-elytron/guides/">Guides</a>
            
            
            
            
            
                <a class="mdl-navigation__link Docs-menuitem" href="/wildfly-elytron/docs/">Docs</a>
            
            
            
            
            
                <a class="mdl-navigation__link Community-menuitem" href="/wildfly-elytron/community/">Community</a>
            
            
            
            
            
                <a class="mdl-navigation__link mdl-navigation__link--current Blog-menuitem" href="/wildfly-elytron/blog/">Blog</a>
            
            
            
            
            
                <a class="mdl-navigation__link GitHub-menuitem" href="https://github.com/wildfly-security/wildfly-elytron">GitHub</a>
            
            
            
            
            
                <a class="mdl-navigation__link CVE Reporting-menuitem" href="/wildfly-elytron/security/">CVE Reporting</a>
            
            
            <!-- mdl-navigation__link--current -->
        </nav>
    </div>
    <main class="mdl-layout__content">
        <div class="page-content">
            
            <div class="content">
                <div class="post-page grid-wrapper">
  <div class="grid__item width-12-12 width-12-12-m doc-content">
    <h1>Using Credential Stores to Replace Clear Text Passwords in WildFly</h1>
    <div class="grid-wrapper">
      <div class="grid__item width-8-12 width-12-12-m byline-wrapper">
        
        
          <img class="headshot" src="https://www.gravatar.com/avatar/6ed81e314d6074bbf734abe812f33b05">
        
        <p class="byline">
          By <a href="https://github.com/PrarthonaPaul">Prarthona Paul</a> | August 14, 2024
          <br>
          
            
              <a style="font-size: 0.9em;" href="/wildfly-elytron/blog/tag/credential-store"> #credential-store</a>
            
          
        </p>
      </div>
      
      <div class="grid__item width-4-12 width-12-12-m"><div class="share-page">
  <a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https://wildfly-security.github.io/wildfly-elytron/blog/credential-store-for-passwords/&title=Using Credential Stores to Replace Clear Text Passwords in WildFly" rel="nofollow" target="_blank" title="Share on LinkedIn">
    <i class="fab fa-linkedin"></i>
  </a>
  <a class="share-twitter" href="https://twitter.com/intent/tweet?text=Using Credential Stores to Replace Clear Text Passwords in WildFly&url=https://wildfly-security.github.io/wildfly-elytron/blog/credential-store-for-passwords/&via=WildFlyAS&related=WildFlyAS" rel="nofollow" target="_blank" title="Share on Twitter">
    <i class="fab fa-twitter-square"></i>
  </a>
  <a class="share-facebook" href="https://facebook.com/sharer.php?u=https://wildfly-security.github.io/wildfly-elytron/blog/credential-store-for-passwords/" rel="nofollow" target="_blank" title="Share on Facebook">
    <i class="fab fa-facebook-square"></i>
  </a>
  <a class="share-reddit" href="http://www.reddit.com/submit?url=https://wildfly-security.github.io/wildfly-elytron/blog/credential-store-for-passwords/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" title="Share on Reddit" >
    <i class="fab fa-reddit-square"></i>
  </a>
  <a class="share-email" href="mailto:?subject=Using Credential Stores to Replace Clear Text Passwords in WildFly&amp;body=Using Credential Stores to Replace Clear Text Passwords in WildFly https://wildfly-security.github.io/wildfly-elytron/blog/credential-store-for-passwords/" title="Share via Email" >
    <i class="fas fa-envelope-square"></i>
  </a>
</div>
</div>
      <div class="grid__item width-12-12">
          <div class="paragraph">
<p>WildFly allows the use of credential stores to keep aliases for sensitive information, such as, passwords for external services. Credential stores can be used to store different credentials under aliases and use credential-reference to specify them in server configuration. As a result, the credential is no longer visible in clear text.</p>
</div>
<div id="toc" class="toc">
<div id="toctitle" class="title"></div>
<ul class="sectlevel1">
<li><a href="#prerequisite">Prerequisite</a></li>
<li><a href="#about-credential-reference">About Credential Reference</a></li>
<li><a href="#creating-a-resource-with-plaintext-password">Creating a Resource with Plaintext Password</a></li>
<li><a href="#create-a-credential-store">Create a Credential Store</a></li>
<li><a href="#add-an-entry-to-the-credential-store">Add an Entry to the Credential-Store</a>
<ul class="sectlevel2">
<li><a href="#disable-history-for-the-management-console">Disable History for the Management Console</a></li>
</ul>
</li>
<li><a href="#update-the-keystore-credentials">Update the Keystore Credentials</a></li>
<li><a href="#automatic-credential-store-update">Automatic Credential Store Update</a></li>
<li><a href="#remove-unused-credentials">Remove Unused Credentials</a></li>
<li><a href="#summary">Summary</a></li>
<li><a href="#resources">Resources</a></li>
</ul>
</div>
<div class="sect1">
<h2 id="prerequisite"><a class="anchor" href="#prerequisite"></a>Prerequisite</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To follow along with this guide you will need:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>about 10 minutes</p>
</li>
<li>
<p>WildFly</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="about-credential-reference"><a class="anchor" href="#about-credential-reference"></a>About Credential Reference</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are multiple uses for credential stores, but this blog post will dive deeper into using credential-stores to avoid specifying passwords in clear text. Passwords are used for various resources when configuring the WildFly server, such as a <code>key-store</code> or a <code>key-manager</code>. While it is quick and easy to specify the passwords in clear text, it is not very secure.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-a-resource-with-plaintext-password"><a class="anchor" href="#creating-a-resource-with-plaintext-password"></a>Creating a Resource with Plaintext Password</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let us first create a resource with the password specified as plaintext. To do that, let&#8217;s first start the server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">    $ WILDFLY_HOME/bin/standalone.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the server is running, open another terminal and connect to the cli to configure the server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">    $ WILDFLY_HOME/bin/jboss-cli.sh --connect</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we can create a keystore using a plaintext password:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">/subsystem=elytron/key-store=serverKS:add(path=server.keystore, relative-to=jboss.server.config.dir, type=PKCS12, credential-reference={clear-text=secret})</code></pre>
</div>
</div>
<div class="paragraph">
<p>When configuring a resource using plaintext password, it is stores in the standalone.xml file as seen below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">    &lt;key-store name="serverKS"&gt;
        &lt;credential-reference clear-text="secret"/&gt;
        &lt;implementation type="PKCS12"/&gt;
        &lt;file path="server.keystore" relative-to="jboss.server.config.dir"/&gt;
    &lt;/key-store&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, the password can easily be obtained from the standalone.xml file or using the read-resource() function on the elytron subsystem:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "alias-filter" =&gt; undefined,
        "credential-reference" =&gt; {"clear-text" =&gt; "secret"},
        "path" =&gt; "server.keystore",
        "relative-to" =&gt; "jboss.server.config.dir",
        "required" =&gt; false,
        "provider-name" =&gt; undefined,
        "providers" =&gt; undefined,
        "type" =&gt; "PKCS12"
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, this can be changed using a credential-store and alias to point to the password instead.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create-a-credential-store"><a class="anchor" href="#create-a-credential-store"></a>Create a Credential Store</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A credential store can hold multiple passwords at once, with each password uniquely identified by an alias. When we want to use a password for a resource, we can specify which credential-store it is in and which alias it is under. Let&#8217;s first create a credential store:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">/subsystem=elytron/credential-store=myCredStore:add(location=mycredstore.cs, relative-to=jboss.server.config.dir, credential-reference={clear-text=StorePassword}, create=true)</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you navigate to WILDFLY_HOME/standalone/configuration, you will see a new file has been created there named mycredstore.cs. This file is used to store all the credentials in a credential-store. If you try to view the contents of this file using a text editor, you will see that the file is not human readable. It is possible to programmatically read the passwords, which is what WildFly does when dereferencing the credential reference to access a resource.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="add-an-entry-to-the-credential-store"><a class="anchor" href="#add-an-entry-to-the-credential-store"></a>Add an Entry to the Credential-Store</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to use the credential-store for our keystore, we need to add the keystore password to it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">/subsystem=elytron/credential-store=myCredStore:add-alias(alias=kspass, secret-value=secret)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, <code>alias</code> is the unique identifier that is used to refer to this password entry inside the credential store. The <code>secret-value</code> refers to the actual value of the password.</p>
</div>
<div class="sect2">
<h3 id="disable-history-for-the-management-console"><a class="anchor" href="#disable-history-for-the-management-console"></a>Disable History for the Management Console</h3>
<div class="paragraph">
<p>As you may have noticed, above that we specified the password to be added to the credential store in clear-text. So while it would no longer appear on the standalone.xml file, if someone went through the management CLI history, they can easily find the password. In order to avoid this, we can disable the history using the command below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">[standalone@localhost:9999 /] history --disable</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once you have added your passwords to the credential store, you can enable history again using the command below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">[standalone@localhost:9999 /] history --enable</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="update-the-keystore-credentials"><a class="anchor" href="#update-the-keystore-credentials"></a>Update the Keystore Credentials</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now, we can edit our keystore to use the credential store instead of the clear-text password:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">/subsystem=elytron/key-store=serverKS:write-attribute(name=credential-reference, value={store=myCredStore, alias=kspass})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now if we use the read-resource function, we can no longer see the password:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "alias-filter" =&gt; undefined,
        "credential-reference" =&gt; {
            "store" =&gt; "myCredStore",
            "alias" =&gt; "kspass"
        },
        "path" =&gt; "server.keystore",
        "relative-to" =&gt; "jboss.server.config.dir",
        "required" =&gt; false,
        "provider-name" =&gt; undefined,
        "providers" =&gt; undefined,
        "type" =&gt; "PKCS12"
    },
    "response-headers" =&gt; {"process-state" =&gt; "reload-required"}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="automatic-credential-store-update"><a class="anchor" href="#automatic-credential-store-update"></a>Automatic Credential Store Update</h2>
<div class="sectionbody">
<div class="paragraph">
<p>WildFly also allows us to automatically add a new password to a previously created credential-store when specifying the password for a reference. We can automatically add a new password by using the credential-reference attribute for a resource and by specifying the clear-text password there using the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">/subsystem=elytron/key-store=serverKS:write-attribute(name=credential-reference, value={store=myCredStore, alias=example, clear-text=secret})</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will produce the an output like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{
    "outcome" =&gt; "success",
    "result" =&gt; {"credential-store-update" =&gt; {
        "status" =&gt; "new-entry-added",
        "new-alias" =&gt; "example"
    }},
    "response-headers" =&gt; {
        "operation-requires-reload" =&gt; true,
        "process-state" =&gt; "reload-required"
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see from the output, the credential-store has been updated to add a new credential and that is being used for the keystore now. If you reload the server and call the read-resource function on the keystore, this will be the output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "alias-filter" =&gt; undefined,
        "credential-reference" =&gt; {
            "store" =&gt; "myCredStore",
            "alias" =&gt; "example"
        },
        "path" =&gt; "server.keystore",
        "relative-to" =&gt; "jboss.server.config.dir",
        "required" =&gt; false,
        "provider-name" =&gt; undefined,
        "providers" =&gt; undefined,
        "type" =&gt; "PKCS12"
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice how even though we specified the clear-text password when updating the credentials, it does not show up here. Instead, we can see the name of the credential-store and the alias listed under credential-reference.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="remove-unused-credentials"><a class="anchor" href="#remove-unused-credentials"></a>Remove Unused Credentials</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you are no longer using an alias and would like to remove it from the credential store, then you can do that using the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">/subsystem=elytron/credential-store=myCredStore:remove-alias(alias=myalias)</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, when deleting an alias, you must be careful. If the alias you are trying to delete is currently in use, it may still be removed successfully, leaving the resource&#8217;s credential-reference pointing to a non-existent alias.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="summary"><a class="anchor" href="#summary"></a>Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This blog post introduces us to credential stores and introduces us to one of the use cases for them. There are other use cases for credential-stores when securing resources in the WildFly server. Future guides will cover other use cases.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="resources"><a class="anchor" href="#resources"></a>Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>To learn more about credential stores, please refer to the <a href="https://docs.wildfly.org/30/WildFly_Elytron_Security.html#CredentialStore">documentation</a></p>
</li>
<li>
<p>To learn more about automatic credential-store updates, visit <a href="https://wildfly-security.github.io/wildfly-elytron/blog/automatic-credential-store-updates/">this blog post</a></p>
</li>
<li>
<p>You can also use the <code>read-resource-description</code> function in command line to learn more about the credential-reference resource.</p>
</li>
</ul>
</div>
</div>
</div>
      </div>
    </div>
  </div>
</div>

            </div>
        </div>
    </main>
</div>
</body>
</html>
