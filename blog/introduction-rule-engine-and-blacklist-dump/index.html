<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Elytron: Introduction to Rule Engine & Blacklist IP Dump of Intrusion Detection System</title>
    <script src="/wildfly-elytron/assets/javascript/highlight.pack.js" type="text/javascript"></script>

    <link rel="shortcut icon" type="image/png" href="/wildfly-elytron/favicon.ico">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <!-- We override the colours from this theme manually -->
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
    <link rel="stylesheet" href="/wildfly-elytron/assets/css/styles.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
    <script src="/wildfly-elytron/assets/javascript/hl.js" type="text/javascript"></script>
    <link rel="alternate" type="application/rss+xml"  href="/wildfly-elytron/feed.xml" title="WildFly Elytron">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-135301155-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-135301155-1');
    </script>
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Introduction to Rule Engine &amp; Blacklist IP Dump of Intrusion Detection System | WildFly Elytron</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Introduction to Rule Engine &amp; Blacklist IP Dump of Intrusion Detection System" />
<meta name="author" content="Piyush Palta" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Earlier we introduced Intrusion Detection System using Elytron&#8217;s security events and discussed its architecture. In this blog we&#8217;ll discuss the implementation of Rule Engine &amp; Blacklist IP Dump. Rule Engine Rule Engine comprises of a set of pre-defined rules, which are used to score the event on a scale of 0 to 100. This score helps determine whether an event is safe or risky, this can be decided by setting a risk threshold. Rule Engine is backed by a database that has information such as IP address, user id, event outcome(success or failure) of past security events. Each entry in database has Time to live(TTL) or hop limit of 3 hours, which can be configured based on requirement. Generally speaking rule based engines are robust but can only take on already identified &amp; can&#8217;t do much about new attacks. It does only as much as it is asked for, which though results in extremely low false positives doesn&#8217;t scale well to all situations. That&#8217;s when Machine Learning &amp; anomaly detection engines come into the picture. These engines are currently under development &amp; will be introduced in future posts. Coming back to the Rule Engine, current implementation focuses mainly to prevent dictionary &amp; brute force attacks from happening. There are four rules, each addressing different use cases : Multiple login attempts from same IP Multiple login attempts for same user ID via different IPs Multiple login attempts from IP that was used to access same user ID in past (the risk is relatively low here) Multiple incorrect user ID attempts due to typo (We use edit_distance to subsidize the penalty for each attempt) Implementation available at : https://github.com/piyush-palta/risk-analyzer/blob/master/risk_calculator/rule_engine.py Blacklist IP Dump Blacklist IP Dump is a database of all the IPs that are blacklisted over the internet for malicious behaviour. One such source of blacklisted IP addresses is myip.ms. These IPs are provided in a text file &amp; stored in a sqlite3 based database. IPs are hashed as integers for easy lookup i.e. O(logN) lookup. If an IP is found to be present in this database, highest possible score of 100 is returned and the event is forfeited. Implementation available at : https://github.com/piyush-palta/risk-analyzer/blob/master/risk_calculator/blacklist_ip.py Summary: In this blog, we introduced the rule engine &amp; blacklist IP dump of Intrusion Detection System using Elytron&#8217;s security events &amp; discussed their implementation." />
<meta property="og:description" content="Earlier we introduced Intrusion Detection System using Elytron&#8217;s security events and discussed its architecture. In this blog we&#8217;ll discuss the implementation of Rule Engine &amp; Blacklist IP Dump. Rule Engine Rule Engine comprises of a set of pre-defined rules, which are used to score the event on a scale of 0 to 100. This score helps determine whether an event is safe or risky, this can be decided by setting a risk threshold. Rule Engine is backed by a database that has information such as IP address, user id, event outcome(success or failure) of past security events. Each entry in database has Time to live(TTL) or hop limit of 3 hours, which can be configured based on requirement. Generally speaking rule based engines are robust but can only take on already identified &amp; can&#8217;t do much about new attacks. It does only as much as it is asked for, which though results in extremely low false positives doesn&#8217;t scale well to all situations. That&#8217;s when Machine Learning &amp; anomaly detection engines come into the picture. These engines are currently under development &amp; will be introduced in future posts. Coming back to the Rule Engine, current implementation focuses mainly to prevent dictionary &amp; brute force attacks from happening. There are four rules, each addressing different use cases : Multiple login attempts from same IP Multiple login attempts for same user ID via different IPs Multiple login attempts from IP that was used to access same user ID in past (the risk is relatively low here) Multiple incorrect user ID attempts due to typo (We use edit_distance to subsidize the penalty for each attempt) Implementation available at : https://github.com/piyush-palta/risk-analyzer/blob/master/risk_calculator/rule_engine.py Blacklist IP Dump Blacklist IP Dump is a database of all the IPs that are blacklisted over the internet for malicious behaviour. One such source of blacklisted IP addresses is myip.ms. These IPs are provided in a text file &amp; stored in a sqlite3 based database. IPs are hashed as integers for easy lookup i.e. O(logN) lookup. If an IP is found to be present in this database, highest possible score of 100 is returned and the event is forfeited. Implementation available at : https://github.com/piyush-palta/risk-analyzer/blob/master/risk_calculator/blacklist_ip.py Summary: In this blog, we introduced the rule engine &amp; blacklist IP dump of Intrusion Detection System using Elytron&#8217;s security events &amp; discussed their implementation." />
<link rel="canonical" href="https://wildfly-security.github.io/wildfly-elytron/blog/introduction-rule-engine-and-blacklist-dump/" />
<meta property="og:url" content="https://wildfly-security.github.io/wildfly-elytron/blog/introduction-rule-engine-and-blacklist-dump/" />
<meta property="og:site_name" content="WildFly Elytron" />
<meta property="og:image" content="https://wildfly-security.github.io/wildfly-elytron/assets/images/wildfly-elytron-logo.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-27T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://wildfly-security.github.io/wildfly-elytron/assets/images/wildfly-elytron-logo.jpg" />
<meta property="twitter:title" content="Introduction to Rule Engine &amp; Blacklist IP Dump of Intrusion Detection System" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Piyush Palta"},"dateModified":"2020-07-27T00:00:00+00:00","datePublished":"2020-07-27T00:00:00+00:00","description":"Earlier we introduced Intrusion Detection System using Elytron&#8217;s security events and discussed its architecture. In this blog we&#8217;ll discuss the implementation of Rule Engine &amp; Blacklist IP Dump. Rule Engine Rule Engine comprises of a set of pre-defined rules, which are used to score the event on a scale of 0 to 100. This score helps determine whether an event is safe or risky, this can be decided by setting a risk threshold. Rule Engine is backed by a database that has information such as IP address, user id, event outcome(success or failure) of past security events. Each entry in database has Time to live(TTL) or hop limit of 3 hours, which can be configured based on requirement. Generally speaking rule based engines are robust but can only take on already identified &amp; can&#8217;t do much about new attacks. It does only as much as it is asked for, which though results in extremely low false positives doesn&#8217;t scale well to all situations. That&#8217;s when Machine Learning &amp; anomaly detection engines come into the picture. These engines are currently under development &amp; will be introduced in future posts. Coming back to the Rule Engine, current implementation focuses mainly to prevent dictionary &amp; brute force attacks from happening. There are four rules, each addressing different use cases : Multiple login attempts from same IP Multiple login attempts for same user ID via different IPs Multiple login attempts from IP that was used to access same user ID in past (the risk is relatively low here) Multiple incorrect user ID attempts due to typo (We use edit_distance to subsidize the penalty for each attempt) Implementation available at : https://github.com/piyush-palta/risk-analyzer/blob/master/risk_calculator/rule_engine.py Blacklist IP Dump Blacklist IP Dump is a database of all the IPs that are blacklisted over the internet for malicious behaviour. One such source of blacklisted IP addresses is myip.ms. These IPs are provided in a text file &amp; stored in a sqlite3 based database. IPs are hashed as integers for easy lookup i.e. O(logN) lookup. If an IP is found to be present in this database, highest possible score of 100 is returned and the event is forfeited. Implementation available at : https://github.com/piyush-palta/risk-analyzer/blob/master/risk_calculator/blacklist_ip.py Summary: In this blog, we introduced the rule engine &amp; blacklist IP dump of Intrusion Detection System using Elytron&#8217;s security events &amp; discussed their implementation.","headline":"Introduction to Rule Engine &amp; Blacklist IP Dump of Intrusion Detection System","image":"https://wildfly-security.github.io/wildfly-elytron/assets/images/wildfly-elytron-logo.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://wildfly-security.github.io/wildfly-elytron/blog/introduction-rule-engine-and-blacklist-dump/"},"url":"https://wildfly-security.github.io/wildfly-elytron/blog/introduction-rule-engine-and-blacklist-dump/"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>


<!-- Always shows a header, even in smaller screens. -->
<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
    <header class="mdl-layout__header mdl-layout__header--scroll">
        <div class="mdl-layout__header-row ">
            <!-- Title -->
            <span class="mdl-layout-title"><h3>Wild<strong>Fly</strong>  Elytron</h3></span>
            <!-- Add spacer, to align navigation to the right -->
            <div class="mdl-layout-spacer"></div>
            <nav class="mdl-navigation mdl-layout--large-screen-only">
                
                    
                    
                    
                         <a class="mdl-navigation__link highlight-button Contribute-menuitem" href="/wildfly-elytron/contribute/">Contribute</a>
                    
                
                    
                    
                    
                         <a class="mdl-navigation__link Home-menuitem" href="/wildfly-elytron/">Home</a>
                    
                
                    
                    
                    
                         <a class="mdl-navigation__link Guides-menuitem" href="/wildfly-elytron/guides/">Guides</a>
                    
                
                    
                    
                    
                         <a class="mdl-navigation__link Docs-menuitem" href="/wildfly-elytron/docs/">Docs</a>
                    
                
                    
                    
                    
                         <a class="mdl-navigation__link Community-menuitem" href="/wildfly-elytron/community/">Community</a>
                    
                
                    
                    
                    
                         <a class="mdl-navigation__link mdl-navigation__link--current Blog-menuitem" href="/wildfly-elytron/blog/">Blog</a>
                    
                
                    
                    
                    
                         <a class="mdl-navigation__link GitHub-menuitem" href="https://github.com/wildfly-security/wildfly-elytron">GitHub</a>
                    
                
            </nav>
        </div>
    </header>
    <div class="mdl-layout__drawer">
        <div class="side-drawer-logo-container"><h3>Wild<strong>Fly</strong>  Elytron</h3></div>
        <nav class="mdl-navigation">
            
            
            
            
                <a class="mdl-navigation__link highlight-sidebar Contribute-menuitem" href="/wildfly-elytron/contribute/">Contribute</a>
            
            
            
            
            
                <a class="mdl-navigation__link Home-menuitem" href="/wildfly-elytron/">Home</a>
            
            
            
            
            
                <a class="mdl-navigation__link Guides-menuitem" href="/wildfly-elytron/guides/">Guides</a>
            
            
            
            
            
                <a class="mdl-navigation__link Docs-menuitem" href="/wildfly-elytron/docs/">Docs</a>
            
            
            
            
            
                <a class="mdl-navigation__link Community-menuitem" href="/wildfly-elytron/community/">Community</a>
            
            
            
            
            
                <a class="mdl-navigation__link mdl-navigation__link--current Blog-menuitem" href="/wildfly-elytron/blog/">Blog</a>
            
            
            
            
            
                <a class="mdl-navigation__link GitHub-menuitem" href="https://github.com/wildfly-security/wildfly-elytron">GitHub</a>
            
            
            <!-- mdl-navigation__link--current -->
        </nav>
    </div>
    <main class="mdl-layout__content">
        <div class="page-content">
            
            <div class="content">
                <div class="post-page grid-wrapper">
  <div class="grid__item width-12-12 width-12-12-m doc-content">
    <h1>Introduction to Rule Engine & Blacklist IP Dump of Intrusion Detection System</h1>
    <div class="grid-wrapper">
      <div class="grid__item width-8-12 width-12-12-m byline-wrapper">
        
        
          <img class="headshot" src="https://www.gravatar.com/avatar/1fe80158e423117f4c183179e0c32cb1">
        
        <p class="byline">
          By <a href="https://github.com/piyush-palta">Piyush Palta</a> | July 27, 2020
          <br>
          
            
              <a style="font-size: 0.9em;" href="/wildfly-elytron/blog/tag/intrusion-detection"> #intrusion-detection</a>
            
              <a style="font-size: 0.9em;" href="/wildfly-elytron/blog/tag/rule-engine"> #rule-engine</a>
            
          
        </p>
      </div>
      
      <div class="grid__item width-4-12 width-12-12-m"><div class="share-page">
  <a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https://wildfly-security.github.io/wildfly-elytron/blog/introduction-rule-engine-and-blacklist-dump/&title=Introduction to Rule Engine & Blacklist IP Dump of Intrusion Detection System" rel="nofollow" target="_blank" title="Share on LinkedIn">
    <i class="fab fa-linkedin"></i>
  </a>
  <a class="share-twitter" href="https://twitter.com/intent/tweet?text=Introduction to Rule Engine & Blacklist IP Dump of Intrusion Detection System&url=https://wildfly-security.github.io/wildfly-elytron/blog/introduction-rule-engine-and-blacklist-dump/&via=WildFlyAS&related=WildFlyAS" rel="nofollow" target="_blank" title="Share on Twitter">
    <i class="fab fa-twitter-square"></i>
  </a>
  <a class="share-facebook" href="https://facebook.com/sharer.php?u=https://wildfly-security.github.io/wildfly-elytron/blog/introduction-rule-engine-and-blacklist-dump/" rel="nofollow" target="_blank" title="Share on Facebook">
    <i class="fab fa-facebook-square"></i>
  </a>
  <a class="share-reddit" href="http://www.reddit.com/submit?url=https://wildfly-security.github.io/wildfly-elytron/blog/introduction-rule-engine-and-blacklist-dump/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" title="Share on Reddit" >
    <i class="fab fa-reddit-square"></i>
  </a>
  <a class="share-email" href="mailto:?subject=Introduction to Rule Engine & Blacklist IP Dump of Intrusion Detection System&amp;body=Introduction to Rule Engine & Blacklist IP Dump of Intrusion Detection System https://wildfly-security.github.io/wildfly-elytron/blog/introduction-rule-engine-and-blacklist-dump/" title="Share via Email" >
    <i class="fas fa-envelope-square"></i>
  </a>
</div>
</div>
      <div class="grid__item width-12-12">
          <div class="paragraph">
<p>Earlier we introduced <a href="https://wildfly-security.github.io/wildfly-elytron/blog/architectural-overview-intrusion-detection-system/"><em>Intrusion Detection System</em></a> using Elytron&#8217;s security events and discussed its architecture. In this blog we&#8217;ll discuss the implementation of Rule Engine &amp; Blacklist IP Dump.</p>
</div>
<div class="sect1">
<h2 id="rule-engine"><a class="anchor" href="#rule-engine"></a>Rule Engine</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Rule Engine</em> comprises of a set of pre-defined rules, which are used to score the event on a scale of 0 to 100. This score helps determine whether an event is safe or risky, this can be decided by setting a risk threshold.
Rule Engine is backed by a database that has information such as IP address, user id, event outcome(success or failure) of past security events. Each entry in database has Time to live(TTL) or hop limit of 3 hours, which can be configured based on requirement.
Generally speaking rule based engines are robust but can only take on already identified &amp; can&#8217;t do much about new attacks. It does only as much as it is asked for, which though results in extremely low false positives doesn&#8217;t scale well to all situations.
That&#8217;s when Machine Learning &amp; anomaly detection engines come into the picture. These engines are currently under development &amp; will be introduced in future posts.</p>
</div>
<div class="paragraph">
<p>Coming back to the Rule Engine, current implementation focuses mainly to prevent dictionary &amp; brute force attacks from happening.
<em>There are four rules, each addressing different use cases :</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Multiple login attempts from same IP</p>
</li>
<li>
<p>Multiple login attempts for same user ID via different IPs</p>
</li>
<li>
<p>Multiple login attempts from IP that was used to access same user ID in past (the risk is relatively low here)</p>
</li>
<li>
<p>Multiple incorrect user ID attempts due to typo (We use edit_distance to subsidize the penalty for each attempt)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Implementation available at</em> : <a href="https://github.com/piyush-palta/risk-analyzer/blob/master/risk_calculator/rule_engine.py" class="bare">https://github.com/piyush-palta/risk-analyzer/blob/master/risk_calculator/rule_engine.py</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="blacklist-ip-dump"><a class="anchor" href="#blacklist-ip-dump"></a>Blacklist IP Dump</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Blacklist IP Dump is a database of all the IPs that are blacklisted over the internet for malicious behaviour. One such source of blacklisted IP addresses is <a href="https://myip.ms/browse/blacklist/Blacklist_IP_Blacklist_IP_Addresses_Live_Database_Real-time">myip.ms</a>. These IPs are provided in a text file &amp; stored in a sqlite3 based database. IPs are hashed as integers for easy lookup i.e. O(logN) lookup.
If an IP is found to be present in this database, highest possible score of 100 is returned and the event is forfeited.
<em>Implementation available at</em> : <a href="https://github.com/piyush-palta/risk-analyzer/blob/master/risk_calculator/blacklist_ip.py" class="bare">https://github.com/piyush-palta/risk-analyzer/blob/master/risk_calculator/blacklist_ip.py</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="summary"><a class="anchor" href="#summary"></a>Summary:</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this blog, we introduced the rule engine &amp; blacklist IP dump of Intrusion Detection System using Elytron&#8217;s security events &amp; discussed their implementation.</p>
</div>
</div>
</div>
      </div>
    </div>
  </div>
</div>

            </div>
        </div>
    </main>
</div>
</body>
</html>
